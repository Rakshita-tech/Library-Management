<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="library.css">
</head>

<body id="body">
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-left">
            <img src="logo.jpeg" alt="Logo" class="navbar-logo">
            <span class="navbar-text">Library Management</span>
        </div>
        <div class="navbar-search">
            <!-- Added 'Genres' tab -->
            <div class="navbar-genres">
                <button class="navbar-genres-button" onclick="toggleGenresDropdown()">Genres</button>
                <div id="genresDropdown" class="navbar-genres-dropdown" style="display: none;">
                    <ul>
                        <!-- Fiction Subgenres -->
                        <li onclick="toggleDropdown('fiction')">Fiction</li>
                        <ul id="fiction" style="display: none; padding-left: 20px;">
                            <li onclick="fetchBooks('Literary Fiction', 'Literary Fiction')">Literary Fiction</li>
                            <li onclick="fetchBooks('Mystery', 'Mystery')">Mystery</li>
                            <li onclick="fetchBooks('Thriller', 'Thriller')">Thriller</li>
                            <li onclick="fetchBooks('Horror', 'Horror')">Horror</li>
                            <li onclick="fetchBooks('Historical Fiction', 'Historical Fiction')">Historical Fiction</li>
                            <li onclick="fetchBooks('Romance', 'Romance')">Romance</li>
                            <li onclick="fetchBooks('Science Fiction', 'Science Fiction')">Science Fiction</li>
                            <li onclick="fetchBooks('Fantasy', 'Fantasy')">Fantasy</li>
                            <li onclick="fetchBooks('Dystopian', 'Dystopian')">Dystopian</li>
                            <li onclick="fetchBooks('Adventure', 'Adventure')">Adventure</li>
                        </ul>
                        <!-- Non-Fiction Subgenres -->
                        <li onclick="toggleDropdown('non-fiction')">Non-Fiction</li>
                        <ul id="non-fiction" style="display: none; padding-left: 20px;">
                            <li onclick="fetchBooks('Biography', 'Biography')">Biography</li>
                            <li onclick="fetchBooks('Autobiography', 'Autobiography')">Autobiography</li>
                            <li onclick="fetchBooks('Memoir', 'Memoir')">Memoir</li>
                            <li onclick="fetchBooks('Self-Help', 'Self-Help')">Self-Help</li>
                            <li onclick="fetchBooks('True Crime', 'True Crime')">True Crime</li>
                            <li onclick="fetchBooks('History', 'History')">History</li>
                            <li onclick="fetchBooks('Philosophy', 'Philosophy')">Philosophy</li>
                            <li onclick="fetchBooks('Science', 'Science')">Science</li>
                            <li onclick="fetchBooks('Business & Economics', 'Business & Economics')">Business &
                                Economics</li>
                            <li onclick="fetchBooks('Travel', 'Travel')">Travel</li>
                        </ul>
                        <!-- Children's Books Subgenres -->
                        <li onclick="toggleDropdown('childrens-books')">Children's Books</li>
                        <ul id="childrens-books" style="display: none; padding-left: 20px;">
                            <li onclick="fetchBooks('Picture Books', 'Picture Books')">Picture Books</li>
                            <li onclick="fetchBooks('Early Readers', 'Early Readers')">Early Readers</li>
                            <li onclick="fetchBooks('Middle Grade', 'Middle Grade')">Middle Grade</li>
                            <li onclick="fetchBooks('Young Adult', 'Young Adult (YA)')">Young Adult (YA)</li>
                        </ul>
                        <!-- Other Genres Subgenres -->
                        <li onclick="toggleDropdown('other-genres')">Other Genres</li>
                        <ul id="other-genres" style="display: none; padding-left: 20px;">
                            <li onclick="fetchBooks('Poetry', 'Poetry')">Poetry</li>
                            <li onclick="fetchBooks('Graphic Novels & Comics', 'Graphic Novels & Comics')">Graphic
                                Novels &
                                Comics</li>
                            <li onclick="fetchBooks('Short Stories', 'Short Stories')">Short Stories</li>
                            <li onclick="fetchBooks('Anthology', 'Anthology')">Anthology</li>
                            <li onclick="fetchBooks('Classics', 'Classics')">Classics</li>
                            <li onclick="fetchBooks('Spirituality & Religion', 'Spirituality & Religion')">Spirituality
                                &
                                Religion</li>
                            <li onclick="fetchBooks('Cookbooks', 'Cookbooks')">Cookbooks</li>
                            <li onclick="fetchBooks('Art & Photography', 'Art & Photography')">Art & Photography</li>
                            <li onclick="fetchBooks('Health & Fitness', 'Health & Fitness')">Health & Fitness</li>
                            <li onclick="fetchBooks('Home & Garden', 'Home & Garden')">Home & Garden</li>
                            <li onclick="fetchBooks('Humor', 'Humor')">Humor</li>
                            <li onclick="fetchBooks('Politics & Social Sciences', 'Politics & Social Sciences')">
                                Politics &
                                Social Sciences</li>
                            <li onclick="fetchBooks('Education & Reference', 'Education & Reference')">Education &
                                Reference
                            </li>
                            <li onclick="fetchBooks('Sports & Outdoors', 'Sports & Outdoors')">Sports & Outdoors</li>
                            <li onclick="fetchBooks('Technology & Computers', 'Technology & Computers')">Technology &
                                Computers
                            </li>>
                        </ul>
                    </ul>
                </div>
            </div>
            <input type="text" placeholder="Search books..." id="searchInput" class="navbar-search-input">
            <button onclick="searchBooks()" class="navbar-search-button"> <i class="fas fa-search"></i></button>
        </div>

    </nav>

    <div class="custom-container">
        <div class="custom-left-div">
            <!-- User Profile Section -->
            <div class="user-profile">
                <div class="user-profile-icon">
                    <!-- You can use an icon library or replace with an appropriate user icon -->
                    <span>ðŸ‘¤</span>
                </div>
                <div id="username" class="user-profile-name">John Doe</div>
            </div>
            <h1>Our Books</h1>
            <ul>
                <!-- Fiction Dropdown -->
                <li id="fiction" onclick="toggleDropdown('fictionGenres')">Fiction Books</li>
                <ul id="fictionGenres" style="display: none; padding-left: 20px;">
                    <li onclick="fetchBooks('Literary Fiction', 'Literary Fiction')">Literary Fiction</li>
                    <li onclick="fetchBooks('Mystery', 'Mystery')">Mystery</li>
                    <li onclick="fetchBooks('Thriller', 'Thriller')">Thriller</li>
                    <li onclick="fetchBooks('Horror', 'Horror')">Horror</li>
                    <li onclick="fetchBooks('Historical Fiction', 'Historical Fiction')">Historical Fiction</li>
                    <li onclick="fetchBooks('Romance', 'Romance')">Romance</li>
                    <li onclick="fetchBooks('Science Fiction', 'Science Fiction')">Science Fiction</li>
                    <li onclick="fetchBooks('Fantasy', 'Fantasy')">Fantasy</li>
                    <li onclick="fetchBooks('Dystopian', 'Dystopian')">Dystopian</li>
                    <li onclick="fetchBooks('Adventure', 'Adventure')">Adventure</li>
                </ul>

                <!-- Non-Fiction Dropdown -->
                <li id="nonfiction" onclick="toggleDropdown('nonFictionGenres')">Non-Fiction Books</li>
                <ul id="nonFictionGenres" style="display: none; padding-left: 20px;">
                    <li onclick="fetchBooks('Biography', 'Biography')">Biography</li>
                    <li onclick="fetchBooks('Autobiography', 'Autobiography')">Autobiography</li>
                    <li onclick="fetchBooks('Memoir', 'Memoir')">Memoir</li>
                    <li onclick="fetchBooks('Self-Help', 'Self-Help')">Self-Help</li>
                    <li onclick="fetchBooks('True Crime', 'True Crime')">True Crime</li>
                    <li onclick="fetchBooks('History', 'History')">History</li>
                    <li onclick="fetchBooks('Philosophy', 'Philosophy')">Philosophy</li>
                    <li onclick="fetchBooks('Science', 'Science')">Science</li>
                    <li onclick="fetchBooks('Business & Economics', 'Business & Economics')">Business & Economics</li>
                    <li onclick="fetchBooks('Travel', 'Travel')">Travel</li>
                </ul>

                <!-- Children's Books Dropdown -->
                <li id="children" onclick="toggleDropdown('childrenGenres')">Children's Books</li>
                <ul id="childrenGenres" style="display: none; padding-left: 20px;">
                    <li onclick="fetchBooks('Picture Books', 'Picture Books')">Picture Books</li>
                    <li onclick="fetchBooks('Early Readers', 'Early Readers')">Early Readers</li>
                    <li onclick="fetchBooks('Middle Grade', 'Middle Grade')">Middle Grade</li>
                    <li onclick="fetchBooks('Young Adult', 'Young Adult (YA)')">Young Adult (YA)</li>
                </ul>

                <!-- Other Genres Dropdown -->
                <li id="other" onclick="toggleDropdown('otherGenres')">Other Genres</li>
                <ul id="otherGenres" style="display: none; padding-left: 20px;">
                    <li onclick="fetchBooks('Poetry', 'Poetry')">Poetry</li>
                    <li onclick="fetchBooks('Graphic Novels & Comics', 'Graphic Novels & Comics')">Graphic Novels &
                        Comics</li>
                    <li onclick="fetchBooks('Short Stories', 'Short Stories')">Short Stories</li>
                    <li onclick="fetchBooks('Anthology', 'Anthology')">Anthology</li>
                    <li onclick="fetchBooks('Classics', 'Classics')">Classics</li>
                    <li onclick="fetchBooks('Spirituality & Religion', 'Spirituality & Religion')">Spirituality &
                        Religion</li>
                    <li onclick="fetchBooks('Cookbooks', 'Cookbooks')">Cookbooks</li>
                    <li onclick="fetchBooks('Art & Photography', 'Art & Photography')">Art & Photography</li>
                    <li onclick="fetchBooks('Health & Fitness', 'Health & Fitness')">Health & Fitness</li>
                    <li onclick="fetchBooks('Home & Garden', 'Home & Garden')">Home & Garden</li>
                    <li onclick="fetchBooks('Humor', 'Humor')">Humor</li>
                    <li onclick="fetchBooks('Politics & Social Sciences', 'Politics & Social Sciences')">Politics &
                        Social Sciences</li>
                    <li onclick="fetchBooks('Education & Reference', 'Education & Reference')">Education & Reference
                    </li>
                    <li onclick="fetchBooks('Sports & Outdoors', 'Sports & Outdoors')">Sports & Outdoors</li>
                    <li onclick="fetchBooks('Technology & Computers', 'Technology & Computers')">Technology & Computers
                    </li>

                </ul>
            </ul>

        </div>
        <div class="custom-right-div" id="welcome-section">
            <h2 id="custom-right-heading">A room without books is like a body without a soul</h2>
            <div id="custom-card-grid" class="custom-card-grid">
                <!-- Book cards will be dynamically added here -->
            </div>
            <button id="viewMoreButton" class="view-more-button" onclick="viewMoreBooks()" style="display: none;">View
                More</button>
        </div>

    </div>
    <script>
        const apiKey = "AIzaSyAYlD0MXFtLsMonDeYVgiy8EJjZmpBDo9A"; // Replace with your actual Google Books API key
        let startIndex = 0; // Initialize start index for pagination
        let currentCategory = ''; // Store the current category for fetching more books



        //****************** For Genres*******************
        function toggleGenresDropdown() {
            const dropdown = document.getElementById('genresDropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }

        function toggleDropdown(dropdownId) {
            const dropdowns = ['fictionGenres', 'nonFictionGenres', 'childrenGenres', 'otherGenres'];

            dropdowns.forEach(id => {
                const dropdown = document.getElementById(id);
                if (id === dropdownId) {
                    dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
                } else {
                    dropdown.style.display = 'none';
                }
            });
        }



        // Function to search books
        function searchBooks() {
            const query = document.getElementById('searchInput').value;
            if (query) {
                startIndex = 0; // Reset start index for a new search
                fetchBooks(query, query + ' Books');
            }
        }

        // Event listener for the 'Enter' key
        document.getElementById('searchInput').addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                searchBooks();
            }
        });

        // Function to fetch books from Google Books API
        function fetchBooks(category, displayCategory) {
            const genresDropdown = document.getElementById('genresDropdown');
            genresDropdown.style.display = 'none';
            const customRightDiv = document.querySelector('.custom-right-div');
            customRightDiv.style.backgroundImage = 'none'; // Remove background image when books are loaded
            const customRightHeading = document.getElementById('custom-right-heading');
            customRightHeading.textContent = `Loading books...`; // Optional loading text

            // Store current category for loading more books
            currentCategory = category;

            // Fetch books from the Google Books API
            const url = `https://www.googleapis.com/books/v1/volumes?q=${category}&key=${apiKey}&startIndex=${startIndex}&maxResults=12`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    updateBooks(data.items, displayCategory);
                    toggleViewMoreButton(data.totalItems > startIndex + 9); // Show button if more books are available
                })
                .catch(error => console.error('Error fetching books:', error));

        }

        // Function to update books in the UI
        function updateBooks(books, displayCategory) {
            const customRightHeading = document.getElementById('custom-right-heading');
            const customCardGrid = document.querySelector('.custom-card-grid');

            if (startIndex === 0) {
                // Clear previous book cards only if it's a new search
                customCardGrid.innerHTML = '';
            }

            // Update heading to show the clicked category name
            customRightHeading.textContent = `${displayCategory} Books`;

            // Loop through the books and create new book cards
            books.forEach(book => {
                const bookInfo = book.volumeInfo;

                // Create a new div element for the book card
                const cardDiv = document.createElement('div');
                cardDiv.className = 'custom-card';

                // Create an image element for the book cover
                const bookCover = document.createElement('img');
                bookCover.src = bookInfo.imageLinks ? bookInfo.imageLinks.thumbnail : 'https://via.placeholder.com/128x192?text=No+Image';
                bookCover.alt = bookInfo.title;

                // Create an h3 element for the book title
                const bookTitle = document.createElement('h3');
                bookTitle.textContent = bookInfo.title;

                // Create a p element for the author's name
                const bookAuthor = document.createElement('p');
                bookAuthor.textContent = bookInfo.authors ? `Author: ${bookInfo.authors.join(', ')}` : 'Author: Unknown';
                bookAuthor.style.fontStyle = 'italic'; // Optional: style to differentiate author name

                // Create a p element for the publication year
                const bookYear = document.createElement('p');
                bookYear.textContent = bookInfo.publishedDate ? `Published: ${bookInfo.publishedDate.split('-')[0]}` : 'Published: N/A';
                bookYear.style.fontSize = '14px'; // Optional: smaller font for less emphasis

                // Create a p element for the book description
                const bookDescription = document.createElement('p');
                bookDescription.textContent = bookInfo.description ? bookInfo.description.substring(0, 100) + '...' : 'No description available';

                // Create a button element
                const readMoreButton = document.createElement('button');
                readMoreButton.textContent = 'Read More';
                readMoreButton.onclick = () => window.open(bookInfo.infoLink, '_blank');

                // Append all elements to the card div
                cardDiv.appendChild(bookCover);
                cardDiv.appendChild(bookTitle);
                cardDiv.appendChild(bookAuthor);
                cardDiv.appendChild(bookYear);
                cardDiv.appendChild(bookDescription);
                cardDiv.appendChild(readMoreButton);

                // Append the card div to the card grid
                customCardGrid.appendChild(cardDiv);
            });
        }

        // Function to handle "View More" button click
        function viewMoreBooks() {
            startIndex += 9; // Increment the start index to load more books
            fetchBooks(currentCategory, currentCategory + ' Books');
        }

        // Function to toggle "View More" button visibility
        function toggleViewMoreButton(show) {
            const viewMoreButton = document.getElementById('viewMoreButton');
            viewMoreButton.style.display = show ? 'block' : 'none';
        }

        function toggleDropdown(id) {
            const dropdown = document.getElementById(id);
            const displayStyle = dropdown.style.display;

            // Hide all dropdowns first
            const allDropdowns = document.querySelectorAll('ul[id$="Genres"]');
            allDropdowns.forEach(dd => dd.style.display = 'none');

            // Toggle the selected dropdown
            dropdown.style.display = displayStyle === 'none' ? 'block' : 'none';
        }

        // Retrieve the logged-in username from localStorage
        const loggedInUser = localStorage.getItem("loggedInUser");

        // Display the username in the designated element
        if (loggedInUser) {
            document.getElementById("username").textContent = loggedInUser;
        } else {
            // Redirect to login page if no user is logged in
            window.location.href = "login.html";
        }
        document.addEventListener('click', function (event) {
            const genresDropdown = document.getElementById('genresDropdown');
            const genresButton = document.querySelector('.navbar-genres-button');

            // Check if the click was outside the dropdown and the button
            if (!genresDropdown.contains(event.target) && !genresButton.contains(event.target)) {
                genresDropdown.style.display = 'none';
            }
        });

        function toggleGenresDropdown() {
            const dropdown = document.getElementById('genresDropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }


    </script>
</body>

</html>